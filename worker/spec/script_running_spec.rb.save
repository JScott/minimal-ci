require_relative '../lib/scripts'
require 'rspec/mocks'

describe 'work_on' do
  it 'logs debug info' do
    expect_any_instance_of(Logger).to receive(:info).with(/Running/)
    expect_any_instance_of(Logger).to receive(:info).with(/1/)
    expect_any_instance_of(Logger).to receive(:info).with(/exit status/)
    work_on 'echo 1'
  end
end

describe 'start_job'
  before(:context) do
    @job = 'test-job'
    @scripts = ['echo 1']
  end
  
  it 'works out of a workspace' do
    expect(Dir).to receive(:chdir).with(/worker\/workspaces/)
    start_job @job_name
  end
end
